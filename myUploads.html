<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Notes Gallery - Notes Library</title>

    <!-- Css File -->
    <link rel="stylesheet" href="assets/css/style.css" />

    <!-- Favicon Link -->
    <link
      rel="icon"
      type="image/png"
      href="assets/images/logo_icon.png"
      sizes="16x16"
    />

    <!-- Bootstrap Css Link -->
    <link rel="stylesheet" href="assets/css/bootstrap.min.css" />

    <!-- owlCarousel css links -->
    <link rel="stylesheet" href="assets/css/owl.carousel.min.css" />
    <link rel="stylesheet" href="assets/css/owl.theme.default.min.css" />

    <!-- Google Fonts Links  -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=Work+Sans:ital,wght@0,100..900;1,100..900&display=swap"
      rel="stylesheet"
    />

    <!-- fontawesome icons -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css"
      integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />

    <!-- Grid.js Css File -->
    <link rel="stylesheet" href="assets/css/mermaid.min.css" />

    <!-- Bootstrap select css  -->
    <link rel="stylesheet" href="assets/css/bootstrap-select.css" />
  </head>
  <body>
    <main id="myuploads-page">
      <!-- Header Section Starts -->
      <section id="header-section" class="px-4 shadow-sm">
        <nav class="navbar navbar-expand-lg">
          <div class="container-fluid">
            <a class="navbar-brand d-flex align-items-center" href="index.html">
              <img src="assets/images/logo_icon.png" alt="icon" />
              <h5 class="mb-0 ms-2">Notes Gallery</h5>
            </a>
            <button
              class="navbar-toggler"
              type="button"
              data-bs-toggle="collapse"
              data-bs-target="#navbarNav"
              aria-controls="navbarNav"
              aria-expanded="false"
              aria-label="Toggle navigation"
            >
              <span class="navbar-toggler-icon"></span>
            </button>
            <div
              class="collapse navbar-collapse justify-content-end"
              id="navbarNav"
            >
              <ul class="navbar-nav pt-2 ps-3 ps-md-4">
                <li class="nav-item">
                  <a class="nav-link me-3 text-black" href="index.html">Home</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link me-3 text-black" href="notes_library.html"
                    >Notes Library</a
                  >
                </li>
                <li class="nav-item">
                  <a
                    class="d-lg-block d-none nav-link me-3 text-black theme-btn rounded-pill px-3 py-2 font-work-sans"
                    href="login.html"
                    >Login</a
                  >
                  <a
                    class="nav-link d-md-none me-3 text-black"
                    href="login.html"
                    >Login</a
                  >
                </li>
                <li class="nav-item">
                  <a
                    class="d-lg-block d-none nav-link me-3 text-black theme-btn rounded-pill px-3 py-2 font-work-sans"
                    href="register.html"
                    >Register</a
                  >
                  <a
                    class="nav-link d-md-none me-3 text-black"
                    href="register.html"
                    >Register</a
                  >
                </li>
              </ul>
            </div>
          </div>
        </nav>
      </section>
      <!-- Header Section Ends -->

      <!-- My Uploads Section Starts -->
      <section id="myuploads-section" class="py-5">
        <div class="container px-5">
          <div class="section-title mb-4">
            <h2 class="fw-bold">My Uploads</h2>
            <p class="form-control-text-color fs-14">
              Manage your shared notes and resources
            </p>
          </div>
          <div class="row">
            <div class="col-lg-6">
              <div class="card rounded-4 border-secondary-subtle p-4">
                <p class="">Total Uploads</p>
                <h4 class="fw-bold fs-26 total_uploads">14</h4>
              </div>
            </div>
            <div class="col-lg-6">
              <div class="card rounded-4 border-secondary-subtle p-4">
                <p class="">Total Downloads</p>
                <h4 class="fw-bold fs-26 total_downloads">230</h4>
              </div>
            </div>
          </div>
          <div class="uploaded-notes mt-5">
            <h5 class="fw-bold fs-22 mb-4 ps-2">Uploaded Notes</h5>
            <div id="table-wrapper"></div>
          </div>
        </div>
      </section>
      <!-- My Uploads Section Starts -->

      <!-- Footer Section Starts -->
      <section id="footer-section" class="pb-4 pt-md-5 pt-4 mt-lg-3">
        <div class="container">
          <div class="row">
            <div class="col-md-4 col-6 text-center">
              <a href="about.html" class="text-decoration-none text-black-50 fs-sm-14">About Us</a>
            </div>
            <div class="col-md-4 col-6 text-center">
              <a href="contact.html" class="text-decoration-none text-black-50 fs-sm-14">Contact Us</a>
            </div>
            <div class="col-md-4 col-12 text-center">
              <a href="privacy_policy.html" class="text-decoration-none text-black-50 fs-sm-14">Privacy Policy</a>
            </div>
            <div class="col-lg-12">
              <p class="text-black-50 text-center fs-sm-14 my-3">
                &copy;2025 Notes Gallery. All rights reserved.
              </p>
            </div>
          </div>
        </div>
      </section>
      <!-- Footer Section Ends -->

      <!-- Modal Box Starts -->
      <div
        class="modal fade"
        id="exampleModal"
        tabindex="-1"
        aria-labelledby="exampleModalLabel"
        aria-hidden="true"
      >
        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
          <div class="modal-content">
            <div class="modal-header">
              <h1 class="modal-title fs-5" id="exampleModalLabel">
                Modal title
              </h1>
              <button
                type="button"
                class="btn-close"
                data-bs-dismiss="modal"
                aria-label="Close"
              ></button>
            </div>
            <div class="modal-body">...</div>
            <div class="modal-footer">
              <button
                type="button"
                class="btn btn-secondary"
                data-bs-dismiss="modal"
              >
                Close
              </button>
              <button type="button" class="btn btn-primary">
                Save changes
              </button>
            </div>
          </div>
        </div>
      </div>
      <!-- Modal Box Ends -->
    </main>

    <script src="assets/js/jquery-3.7.1.min.js"></script>
    <script src="assets/js/bootstrap.bundle.min.js"></script>
    <script src="assets/js/bootstrap-select.js"></script>
    <script src="assets/js/owl.carousel.min.js"></script>
    <script src="assets/js/gridjs.umd.js"></script>
    <script src="assets/js/sweetalert2.all.min.js"></script>
    <script src="assets/js/config.js"></script>
    <script src="assets/js/main.js"></script>

    <!-- Data Table Script Starts -->
    <script>
      const grid = new gridjs.Grid({
        columns: ["Title", "Course", "Semester / Year", "Action"],
        server: {
          url: `${API_BASE_URL}/notes/get-my-uploads`,
          then: (data) =>
            data.data.uploads.docs.map((note) => [
              gridjs.html(`<span class="text-capitalize">${note.title}</span>`),
              note.course.name,
              `${note.semester ? note.semester : note.year}${
                (note.semester || note.year) === 1
                  ? "st"
                  : (note.semester || note.year) === 2
                  ? "nd"
                  : (note.semester || note.year) === 3
                  ? "rd"
                  : "th"
              } ${note.semester ? "semester" : "year"}`,
              gridjs.html(
                `<a href="#" onclick="buildModal('${note.title}','${note.file_url}')" data-bs-toggle="modal" data-bs-target="#exampleModal"
                class="view-btn text-decoration-none form-control-text-color fw-semibold pe-2 m-0">
                View
                </a> |
                <a href="#" onclick="downloadNote('${note.title}','${note.file_url}')" class="text-decoration-none form-control-text-color fw-semibold ps-2 m-0" >
                  Download
                </a>`
              ),
            ]),
          handle: async (res) => {
            let resJson = await res.json();
            if (resJson.success) {
              document.querySelector(".total_uploads").innerText = resJson.data.total_uploads;
              document.querySelector(".total_downloads").innerText = resJson.data.total_downloads;
              return resJson;
            } else {
              return { data: [] };
            }
          },
          total: (data) => data.data.uploads.totalDocs,
        },
        pagination: {
          enabled: true,
          limit: 5,
          server: {
            url: (prev, page, limit) => {
              const separator = prev.includes("?") ? "&" : "?";
              return `${prev}${separator}limit=${limit}&page=${page}`;
            },
          },
        },
        search: false,
        sort: true,
      }).render(document.getElementById("table-wrapper"));
    </script>
    <!-- Data Table Script Ends -->
  </body>
</html>
